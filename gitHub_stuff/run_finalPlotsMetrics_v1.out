
R version 3.0.2 (2013-09-25) -- "Frisbee Sailing"
Copyright (C) 2013 The R Foundation for Statistical Computing
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ##########
> ## Plots and metrics
> ##########
> # 4/18/2014
> 
> rm(list=objects())
> options(stringsAsFactors = FALSE)
> dir <- "/projects/cidr/Ambrosone/"
> 
> ## preview some chrom's that have succesfully completed combining, for masked SNP test
> 
> imp_dir <- paste(dir,"imputation/", sep="")
> out_dir <- paste(dir,"sarahcn/plots/", sep="")
> study <- "Ambrosone"
> schr <- 1
> echr <- 23
> 
> source("/projects/geneva/geneva_sata/GCC_code/Imputation_IMPUTE2/R_functions/Make_Final_Plots.R")
> 
> ## full set of graphs
> make.finalimp.plot(imp_dir, out_dir, project=study, start_chr=schr, end_chr=echr)
Reading in imputation metrics on chroms 1 through 23 ...
Reading chrom 1 ...
Reading chrom 2 ...
Reading chrom 3 ...
Reading chrom 4 ...
Reading chrom 5 ...
Reading chrom 6 ...
Reading chrom 7 ...
Reading chrom 8 ...
Reading chrom 9 ...
Reading chrom 10 ...
Reading chrom 11 ...
Reading chrom 12 ...
Reading chrom 13 ...
Reading chrom 14 ...
Reading chrom 15 ...
Reading chrom 16 ...
Reading chrom 17 ...
Reading chrom 18 ...
Reading chrom 19 ...
Reading chrom 20 ...
Reading chrom 21 ...
Reading chrom 22 ...
Reading chrom 23 ...
Total of 23040968 SNPS and 1373259 indels and structural variants...
Printing SNP summary by chrom
Plots will represent a total of 22824712 imputed SNPs and 1373259 imputed SVs and indels  

Summaries of imputed variants passing various 'info' score thresholds:
Fraction of SNPs with info > 0.3 is 0.8438 
Fraction of SVs and indels with info > 0.3 is 0.9006 
Fraction of all imputed variants with info > 0.3 is 0.847 
Fraction of SNPs with info > 0.5 is 0.4821 
Fraction of SVs and indels with info > 0.5 is 0.5575 
Fraction of all imputed variants with info > 0.5 is 0.4864 
Fraction of SNPs with info > 0.8 is 0.1577 
Fraction of SVs and indels with info > 0.8 is 0.1975 
Fraction of all imputed variants with info > 0.8 is 0.1599 
making boxplots for snp variants
making boxplots for svs_indels variants
making boxplots for all variants
plotting info by MAF bin for snp variants
plotting info by MAF bin for svs_indels variants
plotting info by MAF bin for all variants
     Total number of masked SNPs will be 216256 ...
     There are a total of 0 masked SVs and indels, which will be not be plotted/summarized...
Dichotomizing masked SNP metrics by study MAF of  0.05 
Summary of concord_type0 
>>>>> MAF <  0.05 , mean= 0.9877323 median= 0.995 ...
>>>>> MAF >= 0.05 , mean= 0.9170521 median= 0.976 ...
Summary of r2_type0 
>>>>> MAF <  0.05 , mean= 0.4981907 median= 0.528 ...
>>>>> MAF >=  0.05 , mean= 0.7976319 median= 0.933 ...
Count of SNPs w/study MAF <  0.05 :  83910 
Count of SNPs w/study MAF >=  0.05 :  132346 
Deleting /projects/cidr/Ambrosone/sarahcn/plots/Ambrosone_chr1-23.allelemap.RData 
> 
> 
> ## focus on masked SNPs to get strand check picture (i.e. sanity check on revised allele mappings)
> # make.finalimp.plot(imp_dir, out_dir, project=study, start_chr=schr, end_chr=echr,
> #                    sets="masked",plots="masked_check_strand")
> 
